<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Walk Simulation</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        canvas {
            border: 2px solid #333;
            background-color: #fff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
        }
    </style>
</head>

<body>
    <h1>Random Walk Simulation</h1>
    <canvas id="canvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const API_URL = '/api/positions';
        const POLL_INTERVAL = 50; // milliseconds

        function drawCircle(x, y, radius, color) {
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function render(enemies, allies) {
            clearCanvas();

            // Draw enemies (red)
            enemies.forEach(enemy => {
                drawCircle(enemy.x, enemy.y, 10, '#ff4444');
            });

            // Draw allies (blue)
            allies.forEach(ally => {
                drawCircle(ally.x, ally.y, 10, '#4444ff');
            });
        }

        async function fetchPositions() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                render(data.enemies, data.allies);
            } catch (error) {
                console.error('Error fetching positions:', error);
            }
        }

        // Start polling
        setInterval(fetchPositions, POLL_INTERVAL);
        fetchPositions(); // Initial fetch
    </script>
</body>

</html>